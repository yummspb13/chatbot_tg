# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

## üî¥ –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ `npm run check:production:env` –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:

### 1. ‚ùå AI_PROVIDER —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–∞–∫ MOCK
**–ü—Ä–æ–±–ª–µ–º–∞:** –í –ª–æ–∫–∞–ª—å–Ω–æ–º `.env` —Ñ–∞–π–ª–µ `AI_PROVIDER=mock`, –Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –Ω—É–∂–µ–Ω `openai`

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ Vercel Dashboard ‚Üí –≤–∞—à –ø—Ä–æ–µ–∫—Ç ‚Üí Settings ‚Üí Environment Variables
2. –ù–∞–π–¥–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `AI_PROVIDER`
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∫–∞–∫ `openai` (–Ω–µ `mock`)
4. –ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –Ω–µ—Ç –∏–ª–∏ –æ–Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∫–∞–∫ `mock`, –∏–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ `openai`
5. –ü–µ—Ä–µ–¥–µ–ø–ª–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç (Redeploy –≤ Vercel)

### 2. ‚ùå MAIN_APP_URL –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Worker
**–ü—Ä–æ–±–ª–µ–º–∞:** Worker –Ω–µ –∑–Ω–∞–µ—Ç, –∫—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ Render.com Dashboard (–∏–ª–∏ –¥—Ä—É–≥–æ–π —Å–µ—Ä–≤–∏—Å, –≥–¥–µ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç Worker)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –≤–∞—à Web Service ‚Üí Environment
3. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é:
   - **Key:** `MAIN_APP_URL`
   - **Value:** `https://chatbot-tg.vercel.app` (–±–µ–∑ `/api/tg/webhook`)
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
5. Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç —Å–µ—Ä–≤–∏—Å

### 3. ‚ö†Ô∏è Webhook —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL
**–ü—Ä–æ–±–ª–µ–º–∞:** Webhook –±—ã–ª —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ –ø—Ä–∏–º–µ—Ä URL `https://your-app.vercel.app/api/tg/webhook`

**–†–µ—à–µ–Ω–∏–µ:**
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ webhook –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL:

```bash
npm run webhook:set:prod https://chatbot-tg.vercel.app
```

**–í–∞–∂–Ω–æ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–π URL –≤–∞—à–µ–≥–æ Vercel –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –Ω–µ –ø—Ä–∏–º–µ—Ä!

## ‚úÖ –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –®–∞–≥ 1: –ò—Å–ø—Ä–∞–≤–∏—Ç—å AI_PROVIDER –≤ Vercel

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://vercel.com/dashboard
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
3. Settings ‚Üí Environment Variables
4. –ù–∞–π–¥–∏—Ç–µ `AI_PROVIDER`:
   - –ï—Å–ª–∏ –µ—Å—Ç—å –∏ –∑–Ω–∞—á–µ–Ω–∏–µ `mock` ‚Üí –∏–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ `openai`
   - –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí –¥–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é:
     - Key: `AI_PROVIDER`
     - Value: `openai`
     - Environment: Production (–∏ Preview, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ
6. –ü–µ—Ä–µ–¥–µ–ø–ª–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç:
   - Deployments ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π deployment ‚Üí ‚ãÆ ‚Üí Redeploy

### –®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å MAIN_APP_URL –≤ Worker

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://dashboard.render.com
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à Web Service (Worker)
3. Environment ‚Üí Add Environment Variable
4. –î–æ–±–∞–≤—å—Ç–µ:
   - **Key:** `MAIN_APP_URL`
   - **Value:** `https://chatbot-tg.vercel.app`
   - (–ë–µ–∑ `/api/tg/webhook` –≤ –∫–æ–Ω—Ü–µ!)
5. Save Changes
6. Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç —Å–µ—Ä–≤–∏—Å

### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π webhook

```bash
npm run webhook:set:prod https://chatbot-tg.vercel.app
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
npm run webhook:check
```

–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:
```
‚úÖ Webhook –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞!
   URL: https://chatbot-tg.vercel.app/api/tg/webhook
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å webhook endpoint

```bash
curl https://chatbot-tg.vercel.app/api/tg/webhook
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "status": "ok",
  "environment": "production",
  "aiProvider": "openai",
  "aiProviderStatus": "openai",
  "timestamp": "..."
}
```

‚ö†Ô∏è –ï—Å–ª–∏ `aiProvider` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `"mock"` - –∑–Ω–∞—á–∏—Ç `AI_PROVIDER` –≤ Vercel –≤—Å–µ –µ—â–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–∞–∫ `mock`!

### –®–∞–≥ 5: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

```bash
npm run check:production:env
```

–í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ–ª–∂–Ω—ã –ø—Ä–æ–π—Ç–∏ —É—Å–ø–µ—à–Ω–æ:
- ‚úÖ AI_PROVIDER –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `openai`
- ‚úÖ MAIN_APP_URL –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- ‚úÖ Webhook –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ Vercel

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–¥–µ–ø–ª–æ—è –æ—Ç–∫—Ä–æ–π—Ç–µ Vercel Dashboard ‚Üí –≤–∞—à –ø—Ä–æ–µ–∫—Ç ‚Üí Logs

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ –∫ webhook –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
```
üöÄ Webhook endpoint initialized
   Environment: PRODUCTION
   AI Provider: OPENAI (openai)
```

–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ `AI Provider: MOCK` - –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `AI_PROVIDER` –≤—Å–µ –µ—â–µ –Ω–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞!

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ Worker

–û—Ç–∫—Ä–æ–π—Ç–µ Render.com Dashboard ‚Üí –≤–∞—à Worker ‚Üí Logs

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
```
‚úÖ –ü–æ–ª—É—á–µ–Ω–æ X –∫–∞–Ω–∞–ª–æ–≤ –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞–Ω–∞–ª–æ–≤ –∑–∞–ø—É—â–µ–Ω
```

–ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∫–∞–Ω–∞–ª:
```
üì® –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ –∫–∞–Ω–∞–ª–∞ ...
üîÑ –û—Ç–ø—Ä–∞–≤–ª—è—é —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É –Ω–∞ https://chatbot-tg.vercel.app/api/tg/webhook...
‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –±–æ—Ç—É —á–µ—Ä–µ–∑ webhook
```

### 3. –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–∞–Ω–∞–ª (–∫–æ—Ç–æ—Ä—ã–π –¥–æ–±–∞–≤–ª–µ–Ω –≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Worker - —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Vercel - webhook –¥–æ–ª–∂–µ–Ω –ø–æ–ª—É—á–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥—Ä—É–ø–ø—É `-4993347411` - –¥–æ–ª–∂–Ω–∞ –ø—Ä–∏–π—Ç–∏ –∫–∞—Ä—Ç–æ—á–∫–∞

## üìã –ß–µ–∫–ª–∏—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

- [ ] `AI_PROVIDER=openai` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Vercel (–Ω–µ mock!)
- [ ] `MAIN_APP_URL=https://chatbot-tg.vercel.app` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Worker
- [ ] Webhook —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL: `https://chatbot-tg.vercel.app/api/tg/webhook`
- [ ] Vercel –ø—Ä–æ–µ–∫—Ç –ø–µ—Ä–µ–¥–µ–ø–ª–æ–µ–Ω –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è `AI_PROVIDER`
- [ ] Worker –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è `MAIN_APP_URL`
- [ ] `npm run check:production:env` –ø—Ä–æ—Ö–æ–¥–∏—Ç –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
- [ ] `curl https://chatbot-tg.vercel.app/api/tg/webhook` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `"aiProvider": "openai"`
- [ ] –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é

## üö® –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã –æ—Å—Ç–∞—é—Ç—Å—è

### AI_PROVIDER –≤—Å–µ –µ—â–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç mock

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏–∑–º–µ–Ω–∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –≤ Vercel Dashboard
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ–¥–µ–ø–ª–æ–∏–ª–∏ –ø—Ä–æ–µ–∫—Ç (Redeploy)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –¥–ª—è Production environment
4. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 1-2 –º–∏–Ω—É—Ç—ã –ø–æ—Å–ª–µ –ø–µ—Ä–µ–¥–µ–ø–ª–æ—è –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–Ω–æ–≤–∞

### Worker –Ω–µ –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `MAIN_APP_URL` –≤ Worker - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `https://chatbot-tg.vercel.app` (–±–µ–∑ `/api/tg/webhook`)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Vercel –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ: –æ—Ç–∫—Ä–æ–π—Ç–µ `https://chatbot-tg.vercel.app` –≤ –±—Ä–∞—É–∑–µ—Ä–µ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Worker –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Vercel - –≤–æ–∑–º–æ–∂–Ω–æ, webhook endpoint –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

### Webhook –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ webhook: `npm run webhook:check`
2. –ï—Å–ª–∏ webhook –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: `npm run webhook:set:prod https://chatbot-tg.vercel.app`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å endpoint: `curl https://chatbot-tg.vercel.app/api/tg/webhook`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Vercel –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

