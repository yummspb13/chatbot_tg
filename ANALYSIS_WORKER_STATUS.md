# –ê–Ω–∞–ª–∏–∑ —Å—Ç–∞—Ç—É—Å–∞ Worker

## ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ:

1. **Worker —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω:**
   - ‚úÖ –ü–æ–¥–∫–ª—é—á–∏–ª—Å—è –∫ Telegram —á–µ—Ä–µ–∑ Client API
   - ‚úÖ –ü–æ–ª—É—á–∏–ª –≤—Å–µ 5 –∫–∞–Ω–∞–ª–æ–≤ –∏–∑ API (`https://chatbot-tg.vercel.app/api/channels`)
   - ‚úÖ –°–æ–∑–¥–∞–ª channelsMap —Å 5 –∫–∞–Ω–∞–ª–∞–º–∏:
     - –¢–µ—Å—Ç –ö–∏–¥–¥ (-1003442736774)
     - –ö—É–¥–∞ –ø–æ–π—Ç–∏ –≤ –ü–∏—Ç–µ—Ä–µ —Å –¥–µ—Ç—å–º–∏ (-1001348648713)
     - Free4kids: –¥–µ—Ç—Å–∫–∞—è –∞—Ñ–∏—à–∞ –ü–∏—Ç–µ—Ä–∞ (-1001388592188)
     - –ú–∞–º–∞—Ö–æ–¥ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ (-1001326982950)
     - –ü–∏—Ç–µ—Ä –¥–ª—è –¥–µ—Ç–µ–π ‚Ä¢ –ê—Ñ–∏—à–∞ (-1002054704544)
   - ‚úÖ –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏–π –¥–ª—è UpdateNewMessage –∏ UpdateNewChannelMessage

2. **–û—à–∏–±–∫–∞ AUTH_KEY_DUPLICATED:**
   - ‚ö†Ô∏è –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –∏ –æ–∂–∏–¥–∞–µ–º–æ
   - –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç `check:channel:subscriptions`
   - –ù–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω—É —Å–µ—Å—Å–∏—é –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤ –¥–≤—É—Ö –º–µ—Å—Ç–∞—Ö
   - Worker –Ω–∞ Render.com —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –∫–æ–≥–¥–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –Ω–µ –∑–∞–ø—É—â–µ–Ω

3. **–û—à–∏–±–∫–∏ TIMEOUT:**
   - ‚ö†Ô∏è –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è Telegram Client API
   - –ü—Ä–æ—Å—Ç–æ —Ç–∞–π–º–∞—É—Ç—ã –ø—Ä–∏ –æ–∂–∏–¥–∞–Ω–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
   - –ù–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –µ—Å–ª–∏ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ –∫–∞–Ω–∞–ª–∞—Ö

## ‚ùì –ß—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–æ—Ç —á–∏—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∫–∞–Ω–∞–ª

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**

1. **Worker –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è UpdateNewMessage/UpdateNewChannelMessage –∏–∑ –¥—Ä—É–≥–∏—Ö –∫–∞–Ω–∞–ª–æ–≤**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Worker –Ω–∞ Render.com
   - –ò—â–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏: `üì® –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ –∫–∞–Ω–∞–ª–∞`
   - –ï—Å–ª–∏ —Ç–∞–∫–∏—Ö —Å—Ç—Ä–æ–∫ –Ω–µ—Ç –¥–ª—è –¥—Ä—É–≥–∏—Ö –∫–∞–Ω–∞–ª–æ–≤ - –∑–Ω–∞—á–∏—Ç —Å–æ–±—ã—Ç–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç

2. **–°–æ–±—ã—Ç–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç, –Ω–æ –Ω–µ –ø—Ä–æ—Ö–æ–¥—è—Ç –ø—Ä–æ–≤–µ—Ä–∫—É chatId**
   - –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å: `‚ö†Ô∏è ChatId ... –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Å–ø–∏—Å–∫–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞`
   - –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Ñ–æ—Ä–º–∞—Ç chatId –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç

3. **–°–æ–æ–±—â–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –±–æ—Ç—É, –Ω–æ –±–æ—Ç –∏—Ö –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ Vercel
   - –ò—â–∏—Ç–µ: `handleChannelMessage` –∏–ª–∏ `–ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ –∫–∞–Ω–∞–ª–∞`

## üîç –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:

### –®–∞–≥ 1: –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–∞–∂–¥—ã–π –∫–∞–Ω–∞–ª

1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–∞–∂–¥—ã–π –∫–∞–Ω–∞–ª –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–∞–∂–¥—ã–π –∫–∞–Ω–∞–ª
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Worker –Ω–∞ Render.com

**–ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ –ª–æ–≥–∞—Ö:**
```
üì• EVENT: UpdateNewMessage (–∏–ª–∏ UpdateNewChannelMessage)
‚úÖ –≠—Ç–æ —Å–æ–±—ã—Ç–∏–µ –Ω–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
üì® –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ –∫–∞–Ω–∞–ª–∞ [–Ω–∞–∑–≤–∞–Ω–∏–µ] ([chatId])
üîÑ –û—Ç–ø—Ä–∞–≤–ª—è—é —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É –Ω–∞ https://...
‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –±–æ—Ç—É
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ù–∞ Vercel Dashboard ‚Üí Logs, –∏—â–∏—Ç–µ:
```
üì® –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ –∫–∞–Ω–∞–ª–∞: [–Ω–∞–∑–≤–∞–Ω–∏–µ] ([chatId])
‚úÖ –ö–∞–Ω–∞–ª –Ω–∞–π–¥–µ–Ω: "[–Ω–∞–∑–≤–∞–Ω–∏–µ]"
```

### –®–∞–≥ 3: –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç –≤ Worker

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
- –ê–∫–∫–∞—É–Ω—Ç Client API –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ –∫–∞–Ω–∞–ª (–Ω–æ –≤—ã —Å–∫–∞–∑–∞–ª–∏, —á—Ç–æ –ø–æ–¥–ø–∏—Å–∞–Ω)
- –ö–∞–Ω–∞–ª –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∏ –∞–∫–∫–∞—É–Ω—Ç –Ω–µ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø–∞
- Telegram –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏—è –¥–ª—è —ç—Ç–æ–≥–æ –∫–∞–Ω–∞–ª–∞

**–†–µ—à–µ–Ω–∏–µ:**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∞–∫–∫–∞—É–Ω—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ –≤—Å–µ –∫–∞–Ω–∞–ª—ã
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–∞–Ω–∞–ª—ã –ø—É–±–ª–∏—á–Ω—ã–µ –∏–ª–∏ –∞–∫–∫–∞—É–Ω—Ç –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **–ù–µ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã**, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `TELEGRAM_SESSION_STRING`, –ø–æ–∫–∞ Worker —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Render.com
   - –≠—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É `AUTH_KEY_DUPLICATED`
   - –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫–∏ - –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Worker, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, –∑–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞

2. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏ Worker** –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
   - –≠—Ç–æ –ø–æ–∫–∞–∂–µ—Ç, –ø–æ–ª—É—á–∞–µ—Ç –ª–∏ Worker —Å–æ–±—ã—Ç–∏—è –∏–∑ –≤—Å–µ—Ö –∫–∞–Ω–∞–ª–æ–≤

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** –Ω–∞ Vercel
   - –≠—Ç–æ –ø–æ–∫–∞–∂–µ—Ç, –ø–æ–ª—É—á–∞–µ—Ç –ª–∏ –±–æ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç Worker

## üéØ –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:

–ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∫–∞–Ω–∞–ª:
1. Worker –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ `UpdateNewMessage` –∏–ª–∏ `UpdateNewChannelMessage`
2. Worker –ø—Ä–æ–≤–µ—Ä—è–µ—Ç chatId –≤ channelsMap
3. Worker –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É —á–µ—Ä–µ–∑ webhook
4. –ë–æ—Ç –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –µ–≥–æ —á–µ—Ä–µ–∑ `handleChannelMessage`
5. –°–æ–∑–¥–∞–µ—Ç—Å—è draft –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

–ï—Å–ª–∏ –≤—Å–µ —à–∞–≥–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è - –∑–Ω–∞—á–∏—Ç –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ!

