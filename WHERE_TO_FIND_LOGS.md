# –ì–¥–µ –∏—Å–∫–∞—Ç—å –ª–æ–≥–∏

## üìã –¢—Ä–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ —Å –ª–æ–≥–∞–º–∏

### 1. –í–û–†–ö–ï–† (worker)
**–¢–µ—Ä–º–∏–Ω–∞–ª:** –≥–¥–µ –∑–∞–ø—É—â–µ–Ω `cd worker && npm run dev`

**–ß—Ç–æ –∏—Å–∫–∞—Ç—å:**
- `‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω –∫ Telegram —á–µ—Ä–µ–∑ Client API`
- `üì° –ù–∞—á–∏–Ω–∞—é –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ X –∫–∞–Ω–∞–ª–æ–≤...`
- `üìã –°–ø–∏—Å–æ–∫ –∫–∞–Ω–∞–ª–æ–≤:`
- `üì® –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ –∫–∞–Ω–∞–ª–∞...`
- `üîÑ –û—Ç–ø—Ä–∞–≤–ª—è—é —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É –Ω–∞ http://localhost:3000/api/tg/webhook`
- `‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –±–æ—Ç—É —á–µ—Ä–µ–∑ webhook`

**–ï—Å–ª–∏ –æ—à–∏–±–∫–∞:**
- `‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∫–∞–Ω–∞–ª–æ–≤: 404` - –ø—Ä–æ–±–ª–µ–º–∞ —Å API `/api/channels`
- `‚ùå TELEGRAM_SESSION_STRING –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω` - –Ω—É–∂–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ QR

---

### 2. NEXT.JS –°–ï–†–í–ï–†
**–¢–µ—Ä–º–∏–Ω–∞–ª:** –≥–¥–µ –∑–∞–ø—É—â–µ–Ω `npm run dev`

**–ß—Ç–æ –∏—Å–∫–∞—Ç—å:**
- `üì• WEBHOOK RECEIVED: message` - –∫–æ–≥–¥–∞ –≤–æ—Ä–∫–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ
- `üì® MESSAGE: chatType=channel` - —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ –∫–∞–Ω–∞–ª–∞
- `üìù STEP1: CLASSIFY_MESSAGE` - –Ω–∞—á–∞–ª–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- `üìù STEP2: EXTRACT_EVENT` - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- `üìù STEP3: CREATE_DRAFT` - —Å–æ–∑–¥–∞–Ω–∏–µ —á–µ—Ä–Ω–æ–≤–∏–∫–∞
- `üìù STEP7: SEND_APPROVAL_CARD` - –æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ –Ω–∞ –æ–¥–æ–±—Ä–µ–Ω–∏–µ

**–ï—Å–ª–∏ –æ—à–∏–±–∫–∞:**
- `‚ùå WEBHOOK ERROR` - –æ—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ webhook
- `PrismaClientInitializationError` - –ø—Ä–æ–±–ª–µ–º–∞ —Å –ë–î

---

### 3. –ë–û–¢ (polling —Ä–µ–∂–∏–º)
**–¢–µ—Ä–º–∏–Ω–∞–ª:** –≥–¥–µ –∑–∞–ø—É—â–µ–Ω `npm run bot:polling`

**–ß—Ç–æ –∏—Å–∫–∞—Ç—å:**
- `üîµ handleStart –≤—ã–∑–≤–∞–Ω` - –∫–æ–º–∞–Ω–¥–∞ `/start` –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞
- `‚úÖ –ê–¥–º–∏–Ω –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω` - –¥–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à–µ–Ω
- `üì® [HANDLER] –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ...` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π

---

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞: –í–æ—Ä–∫–µ—Ä –Ω–µ –≤–∏–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –∫–∞–Ω–∞–ª–∞

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤–æ—Ä–∫–µ—Ä–∞:**
1. –ï—Å—Ç—å –ª–∏ `‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω –∫ Telegram —á–µ—Ä–µ–∑ Client API`?
2. –ï—Å—Ç—å –ª–∏ `üì° –ù–∞—á–∏–Ω–∞—é –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ X –∫–∞–Ω–∞–ª–æ–≤...`?
3. –ï—Å—Ç—å –ª–∏ —Å–ø–∏—Å–æ–∫ –∫–∞–Ω–∞–ª–æ–≤?

**–ï—Å–ª–∏ –Ω–µ—Ç –∫–∞–Ω–∞–ª–æ–≤:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `MONITOR_CHANNELS` –≤ `.env` –≤–æ—Ä–∫–µ—Ä–∞
- –ò–ª–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ API `/api/channels` (–¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å JSON, –Ω–µ 404)

### –ü—Ä–æ–±–ª–µ–º–∞: API /api/channels –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 404

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Next.js —Å–µ—Ä–≤–µ—Ä (Ctrl+C –∏ `npm run dev`)
2. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `MONITOR_CHANNELS` –≤ `.env` –≤–æ—Ä–∫–µ—Ä–∞ –Ω–∞–ø—Ä—è–º—É—é

### –ü—Ä–æ–±–ª–µ–º–∞: –í–æ—Ä–∫–µ—Ä –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –±–æ—Ç—É

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤–æ—Ä–∫–µ—Ä–∞:**
- –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `üîÑ –û—Ç–ø—Ä–∞–≤–ª—è—é —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É –Ω–∞ http://localhost:3000/api/tg/webhook`
- –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –±–æ—Ç—É —á–µ—Ä–µ–∑ webhook`

**–ï—Å–ª–∏ –æ—à–∏–±–∫–∞:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `MAIN_APP_URL` –≤ `.env` –≤–æ—Ä–∫–µ—Ä–∞ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `http://localhost:3000`)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Next.js —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω

---

## üìù –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

1. **–í–æ—Ä–∫–µ—Ä –∑–∞–ø—É—â–µ–Ω?**
   ```bash
   ps aux | grep "tsx.*worker"
   ```

2. **Next.js –∑–∞–ø—É—â–µ–Ω?**
   ```bash
   ps aux | grep "next.*dev"
   ```

3. **API —Ä–∞–±–æ—Ç–∞–µ—Ç?**
   ```bash
   curl http://localhost:3000/api/channels -H "Authorization: Bearer YOUR_BOT_API_KEY"
   ```
   –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å JSON, –Ω–µ HTML 404.

