# Troubleshooting: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

## üî¥ –ü—Ä–æ–±–ª–µ–º–∞: `"monitoring": false` –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Render.com

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://dashboard.render.com
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à Web Service
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Environment**
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å:
   - ‚úÖ `MAIN_APP_URL` = `https://chatbot-irhw19y8p-pixelprint.vercel.app`
   - ‚úÖ `BOT_API_KEY` = `17d38eb4c014c524e52675ab75661f0dcc8768cbc749a62e7309fabe6c9905cd`
   - ‚úÖ `BOT_WEBHOOK_URL` = `https://chatbot-irhw19y8p-pixelprint.vercel.app` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –Ω–µ—Ç:**
- –î–æ–±–∞–≤—å—Ç–µ –∏—Ö
- –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ
- Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç —Å–µ—Ä–≤–∏—Å

---

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ Supabase

1. –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Table Editor**
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–±–ª–∏—Ü—ã:
   - `afisha_bot_City` - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≥–æ—Ä–æ–¥–∞
   - `afisha_bot_Channel` - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∫–∞–Ω–∞–ª—ã —Å `isActive: true`

**–ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü—ã –ø—É—Å—Ç—ã–µ:**

**–í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ SQL**
1. –û—Ç–∫—Ä–æ–π—Ç–µ **SQL Editor**
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏–∑ `prisma/seed-data.sql`

**–í–∞—Ä–∏–∞–Ω—Ç B: –ß–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞**
–í Telegram –±–æ—Ç—É:
```
/addcity –ú–æ—Å–∫–≤–∞
/addchannel moskva -1003442736774 "–¢–µ—Å—Ç –ö–∏–¥–¥"
```

---

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–∞–Ω–∞–ª–æ–≤

```bash
curl -H "Authorization: Bearer 17d38eb4c014c524e52675ab75661f0dcc8768cbc749a62e7309fabe6c9905cd" \
     https://chatbot-irhw19y8p-pixelprint.vercel.app/api/channels
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "channels": [
    {
      "chatId": "-1003442736774",
      "title": "–¢–µ—Å—Ç –ö–∏–¥–¥"
    }
  ]
}
```

**–ï—Å–ª–∏ 404:**
- API –Ω–µ –∑–∞–¥–µ–ø–ª–æ–µ–Ω –Ω–∞ Vercel
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Vercel Dashboard ‚Üí –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–ª–æ–π

**–ï—Å–ª–∏ –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤:**
- –ö–∞–Ω–∞–ª—ã –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –±–∞–∑—É
- –ò–ª–∏ –∫–∞–Ω–∞–ª—ã –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã (`isActive: false`)

---

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ worker'–∞

–ù–∞ Render.com Dashboard ‚Üí Logs

**–ß—Ç–æ –∏—Å–∫–∞—Ç—å:**

‚úÖ **–•–æ—Ä–æ—à–∏–µ –ª–æ–≥–∏:**
```
‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω –∫ Telegram —á–µ—Ä–µ–∑ Client API
üîç –ü–æ–ª—É—á–∞—é –∫–∞–Ω–∞–ª—ã –∏–∑ https://chatbot-irhw19y8p-pixelprint.vercel.app/api/channels...
‚úÖ –ü–æ–ª—É—á–µ–Ω–æ 1 –∫–∞–Ω–∞–ª–æ–≤ –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
üì° –ù–∞—á–∏–Ω–∞—é –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ 1 –∫–∞–Ω–∞–ª–æ–≤...
‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞–Ω–∞–ª–æ–≤ –∑–∞–ø—É—â–µ–Ω
```

‚ùå **–ü–ª–æ—Ö–∏–µ –ª–æ–≥–∏:**
```
‚ö†Ô∏è MAIN_APP_URL –∏–ª–∏ BOT_API_KEY –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
‚ö†Ô∏è –ö–∞–Ω–∞–ª—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
‚ö†Ô∏è –ù–µ—Ç –∫–∞–Ω–∞–ª–æ–≤ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
```

---

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–∞–Ω–∞–ª—ã –∞–∫—Ç–∏–≤–Ω—ã

–í Supabase –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
```sql
SELECT id, title, "chatId", "isActive" 
FROM "afisha_bot_Channel";
```

**–í—Å–µ –∫–∞–Ω–∞–ª—ã –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å `isActive: true`**

–ï—Å–ª–∏ `isActive: false`, –æ–±–Ω–æ–≤–∏—Ç–µ:
```sql
UPDATE "afisha_bot_Channel" 
SET "isActive" = true 
WHERE "chatId" = '-1003442736774';
```

---

## üîß –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```bash
# 1. –°—Ç–∞—Ç—É—Å worker
curl https://chatbot-tg.onrender.com/runner/status

# 2. API –∫–∞–Ω–∞–ª–æ–≤
curl -H "Authorization: Bearer 17d38eb4c014c524e52675ab75661f0dcc8768cbc749a62e7309fabe6c9905cd" \
     https://chatbot-irhw19y8p-pixelprint.vercel.app/api/channels

# 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
curl -X POST https://chatbot-tg.onrender.com/runner/stop
curl -X POST https://chatbot-tg.onrender.com/runner/start

# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞
sleep 3
curl https://chatbot-tg.onrender.com/runner/status
```

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç

- [ ] `MAIN_APP_URL` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Render.com
- [ ] `BOT_API_KEY` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Render.com
- [ ] `TELEGRAM_SESSION_STRING` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Render.com
- [ ] –ì–æ—Ä–æ–¥–∞ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ Supabase (`afisha_bot_City`)
- [ ] –ö–∞–Ω–∞–ª—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ Supabase (`afisha_bot_Channel`)
- [ ] –ö–∞–Ω–∞–ª—ã –∞–∫—Ç–∏–≤–Ω—ã (`isActive: true`)
- [ ] API –∫–∞–Ω–∞–ª–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫
- [ ] Worker –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- [ ] –õ–æ–≥–∏ worker'–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —É—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

---

## üêõ –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

### –û—à–∏–±–∫–∞: "‚ö†Ô∏è MAIN_APP_URL –∏–ª–∏ BOT_API_KEY –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã"
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ Render.com Environment

### –û—à–∏–±–∫–∞: "‚ö†Ô∏è –ù–µ—Ç –∫–∞–Ω–∞–ª–æ–≤ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"
**–†–µ—à–µ–Ω–∏–µ:** 
1. –î–æ–±–∞–≤—å—Ç–µ –∫–∞–Ω–∞–ª—ã –≤ Supabase
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `isActive: true`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ API –∫–∞–Ω–∞–ª–æ–≤ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫

### –û—à–∏–±–∫–∞: "API –∫–∞–Ω–∞–ª–æ–≤ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 404"
**–†–µ—à–µ–Ω–∏–µ:** 
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –∑–∞–¥–µ–ø–ª–æ–µ–Ω –ª–∏ API –Ω–∞ Vercel
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª `app/api/channels/route.ts` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
3. –ü–æ–¥–æ–∂–¥–∏—Ç–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –¥–µ–ø–ª–æ—è

### –û—à–∏–±–∫–∞: "isMonitoring: false" –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ worker'–∞ –Ω–∞ Render.com
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–∞–Ω–∞–ª—ã –µ—Å—Ç—å –≤ –±–∞–∑–µ –∏ –∞–∫—Ç–∏–≤–Ω—ã
