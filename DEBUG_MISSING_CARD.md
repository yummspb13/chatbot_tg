# –û—Ç–ª–∞–¥–∫–∞: –∫–∞—Ä—Ç–æ—á–∫–∞ –æ–¥–æ–±—Ä–µ–Ω–∏—è –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è

## –ü—Ä–æ–±–ª–µ–º–∞

Worker —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–¥–∞–ª —Ñ–æ—Ç–æ (4 —Ä–∞–∑–º–µ—Ä–∞), –Ω–æ –∫–∞—Ä—Ç–æ—á–∫–∞ –æ–¥–æ–±—Ä–µ–Ω–∏—è –Ω–µ –¥–æ—à–ª–∞ –¥–æ –≥—Ä—É–ø–ø—ã.

## –ß—Ç–æ –≤–∏–¥–Ω–æ –≤ –ª–æ–≥–∞—Ö

### Worker (Render.com):
- ‚úÖ –ù–∞–π–¥–µ–Ω–æ —Ñ–æ—Ç–æ: 4 —Ä–∞–∑–º–µ—Ä–æ–≤
- ‚úÖ –°–æ–∑–¥–∞–Ω–æ 4 –æ–±—ä–µ–∫—Ç–æ–≤ —Ñ–æ—Ç–æ
- ‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ webhook (200 OK)

### Vercel:
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ –∫–∞–Ω–∞–ª–∞
- ‚úÖ STEP1: FIND_CHANNEL_IN_DB
- ‚úÖ handleChannelMessage –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ
- ‚ùå –ù–ï–¢ –ª–æ–≥–æ–≤ –æ:
  - STEP1: CLASSIFICATION
  - STEP2: EXTRACTION
  - STEP6: SEND_APPROVAL_CARD
  - üñº –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞–π–¥–µ–Ω–æ

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã

### 1. –ë–æ—Ç –Ω–µ –∑–∞–ø—É—â–µ–Ω (isRunning = false)

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –û—Ç–∫—Ä–æ–π—Ç–µ Vercel Dashboard ‚Üí Functions ‚Üí Logs
- –ù–∞–π–¥–∏—Ç–µ –ª–æ–≥–∏ —Å `–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –±–æ—Ç–∞` –∏–ª–∏ `–ë–æ—Ç –Ω–µ –∑–∞–ø—É—â–µ–Ω`

**–†–µ—à–µ–Ω–∏–µ:**
- –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/start` –±–æ—Ç—É –≤ Telegram
- –ò–ª–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

### 2. –°–æ–æ–±—â–µ–Ω–∏–µ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ (–¥—É–±–ª–∏–∫–∞—Ç)

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –û—Ç–∫—Ä–æ–π—Ç–µ Vercel Dashboard ‚Üí Functions ‚Üí Logs
- –ù–∞–π–¥–∏—Ç–µ –ª–æ–≥–∏ —Å `–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤` –∏–ª–∏ `–°–æ–æ–±—â–µ–Ω–∏–µ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ`

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –µ—Å—Ç—å –ª–∏ —á–µ—Ä–Ω–æ–≤–∏–∫ —Å messageId: 105
- –ï—Å–ª–∏ –µ—Å—Ç—å, —É–¥–∞–ª–∏—Ç–µ –µ–≥–æ –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

### 3. –ö–∞–Ω–∞–ª –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –û—Ç–∫—Ä–æ–π—Ç–µ Vercel Dashboard ‚Üí Functions ‚Üí Logs
- –ù–∞–π–¥–∏—Ç–µ –ª–æ–≥–∏ —Å `–ö–∞–Ω–∞–ª –Ω–µ –Ω–∞–π–¥–µ–Ω` –∏–ª–∏ `–ö–∞–Ω–∞–ª –Ω–∞–π–¥–µ–Ω`

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–∞–Ω–∞–ª –¥–æ–±–∞–≤–ª–µ–Ω –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `isActive = true`

### 4. –û—à–∏–±–∫–∞ –≤ –±–ª–æ–∫–µ try-catch

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –û—Ç–∫—Ä–æ–π—Ç–µ Vercel Dashboard ‚Üí Functions ‚Üí Logs
- –ù–∞–π–¥–∏—Ç–µ –ª–æ–≥–∏ —Å `‚ùå` –∏–ª–∏ `Error`

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª–Ω—ã–µ –ª–æ–≥–∏ Vercel –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
- –û—à–∏–±–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, –∏–∑–≤–ª–µ—á–µ–Ω–∏–∏ –∏–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —á–µ—Ä–Ω–æ–≤–∏–∫–∞

## –ß—Ç–æ –¥–µ–ª–∞—Ç—å

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª–Ω—ã–µ –ª–æ–≥–∏ Vercel

1. –û—Ç–∫—Ä–æ–π—Ç–µ Vercel Dashboard ‚Üí Functions ‚Üí Logs
2. –ù–∞–π–¥–∏—Ç–µ –≤—Ä–µ–º—è `21:52:34` (–∫–æ–≥–¥–∞ –±—ã–ª–æ –ø–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ)
3. –ò—â–∏—Ç–µ –ª–æ–≥–∏:
   - `‚úÖ –ö–∞–Ω–∞–ª –Ω–∞–π–¥–µ–Ω`
   - `‚úÖ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω`
   - `‚úÖ –î—É–±–ª–∏–∫–∞—Ç–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ`
   - `üîÑ –ù–∞—á–∏–Ω–∞—é –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–æ–æ–±—â–µ–Ω–∏—è...`
   - `üìä STEP1: CLASSIFICATION`

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –±–æ—Ç–∞

```bash
# –ß–µ—Ä–µ–∑ Telegram –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É:
/start
/status
```

–ò–ª–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:
```sql
SELECT * FROM BotSettings WHERE id = 1;
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞–Ω–∞–ª –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

```bash
npm run check:channels:db
```

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–∞–Ω–∞–ª –∞–∫—Ç–∏–≤–µ–Ω –∏ chatId –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π.

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥—É–±–ª–∏–∫–∞—Ç—ã

```bash
npm run check:draft:images 14
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –Ω–µ—Ç –ª–∏ —É–∂–µ —á–µ—Ä–Ω–æ–≤–∏–∫–∞ —Å messageId: 105.

## –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Å–ª–µ–¥—É—é—â–∏—Ö –ª–æ–≥–∞—Ö –±—É–¥–µ—Ç –≤–∏–¥–Ω–æ:
- `–ö–∞–Ω–∞–ª –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ`
- `–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω, –ø—Ä–æ–¥–æ–ª–∂–∞—é –æ–±—Ä–∞–±–æ—Ç–∫—É`
- `–î—É–±–ª–∏–∫–∞—Ç–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –Ω–∞—á–∏–Ω–∞—é –æ–±—Ä–∞–±–æ—Ç–∫—É`
- `–ù–∞—á–∏–Ω–∞—é –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–æ–æ–±—â–µ–Ω–∏—è`

–≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç —Ç–æ—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –≥–¥–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –æ–±—Ä–∞–±–æ—Ç–∫–∞.

