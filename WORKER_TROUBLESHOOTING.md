# –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Worker (Render.com)

## –ü—Ä–æ–±–ª–µ–º–∞: Worker –Ω–µ —á–∏—Ç–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –∫–∞–Ω–∞–ª–æ–≤

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å worker

```bash
curl https://chatbot-tg.onrender.com/runner/status
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "isRunning": true,
  "monitoring": {
    "isMonitoring": true,
    "isConnected": true
  }
}
```

### –®–∞–≥ 2: –ï—Å–ª–∏ worker –Ω–µ –∑–∞–ø—É—â–µ–Ω

```bash
curl -X POST https://chatbot-tg.onrender.com/runner/start
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "success": true,
  "message": "–í–æ—Ä–∫–µ—Ä –∑–∞–ø—É—â–µ–Ω",
  "isRunning": true,
  "monitoring": true
}
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Render.com

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:

1. **TELEGRAM_SESSION_STRING** - —Å—Ç—Ä–æ–∫–∞ —Å–µ—Å—Å–∏–∏ (–ø–æ–ª—É—á–µ–Ω–∞ —á–µ—Ä–µ–∑ QR-–ª–æ–≥–∏–Ω)
2. **TELEGRAM_API_ID** - ID –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Telegram
3. **TELEGRAM_API_HASH** - Hash –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Telegram
4. **MAIN_APP_URL** - URL –≤–∞—à–µ–≥–æ Vercel –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: `https://your-app.vercel.app`)
5. **BOT_API_KEY** - –∫–ª—é—á –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ API –∫–∞–Ω–∞–ª–æ–≤ (–¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å `BOT_API_KEY` –≤ Vercel)
6. **BOT_WEBHOOK_URL** - URL webhook –±–æ—Ç–∞ (–æ–±—ã—á–Ω–æ —Ç–æ—Ç –∂–µ, —á—Ç–æ –∏ `MAIN_APP_URL`)

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –¥–ª—è –∫–∞–Ω–∞–ª–æ–≤:**
- **MONITOR_CHANNELS** - JSON –º–∞—Å—Å–∏–≤ –∫–∞–Ω–∞–ª–æ–≤:
  ```json
  [{"chatId": "-1001234567890", "title": "–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞"}]
  ```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Render.com

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –∏ –∑–∞–ø—É—Å–∫–∞ worker, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:

1. –û—Ç–∫—Ä–æ–π—Ç–µ Render.com Dashboard
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à worker —Å–µ—Ä–≤–∏—Å
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "Logs"
4. –û–ø—É–±–ª–∏–∫—É–π—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–∞–Ω–∞–ª–µ
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ - –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –∑–∞–ø–∏—Å–∏:

```
üì• EVENT: UpdateNewMessage
   ‚úÖ Event has message
   Message ID: 123
   PeerChannel ID: 1234567890, chatId: -1001234567890
   üì® –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ –∫–∞–Ω–∞–ª–∞ –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞ (-1001234567890)
```

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∞–∫–∫–∞—É–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ –∫–∞–Ω–∞–ª

**–í–∞–∂–Ω–æ:** –ê–∫–∫–∞—É–Ω—Ç `@yummspb` (7007868967) –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ –∫–∞–Ω–∞–ª, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç–µ.

### –®–∞–≥ 6: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç chatId

ChatId –∫–∞–Ω–∞–ª–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ `-100XXXXXXXXXX` (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ, –Ω–∞—á–∏–Ω–∞—é—â–µ–µ—Å—è —Å `-100`).

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ username –∫–∞–Ω–∞–ª–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è chatId:
```bash
npm run get-channel-id -- @channel_username
```

### –®–∞–≥ 7: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–∞–Ω–∞–ª—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–∞–Ω–∞–ª—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑:
- –ö–æ–º–∞–Ω–¥—É –±–æ—Ç–∞: `/addchannel`
- –ò–ª–∏ SQL —Å–∫—Ä–∏–ø—Ç: `prisma/seed-data.sql`

### –®–∞–≥ 8: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–∞–Ω–∞–ª–æ–≤

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ API –∫–∞–Ω–∞–ª–æ–≤ –¥–æ—Å—Ç—É–ø–µ–Ω:

```bash
curl -H "Authorization: Bearer YOUR_BOT_API_KEY" https://your-app.vercel.app/api/channels
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "channels": [
    {"chatId": "-1001234567890", "title": "–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞"}
  ]
}
```

## –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞: "–ù–µ—Ç –∫–∞–Ω–∞–ª–æ–≤ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `MAIN_APP_URL` –∏ `BOT_API_KEY` –≤ Render.com
2. –ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `MONITOR_CHANNELS` —Å JSON –º–∞—Å—Å–∏–≤–æ–º –∫–∞–Ω–∞–ª–æ–≤
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–∞–Ω–∞–ª—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

### –ü—Ä–æ–±–ª–µ–º–∞: "TELEGRAM_SESSION_STRING –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å —á–µ—Ä–µ–∑ QR-–∫–æ–¥ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `TELEGRAM_SESSION_STRING`
3. –î–æ–±–∞–≤—å—Ç–µ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è Render.com

### –ü—Ä–æ–±–ª–µ–º–∞: "ChatId –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Å–ø–∏—Å–∫–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç chatId (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `-100XXXXXXXXXX`)
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ chatId –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º chatId –∫–∞–Ω–∞–ª–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ - —Ç–∞–º –±—É–¥–µ—Ç —Å–ø–∏—Å–æ–∫ –∫–∞–Ω–∞–ª–æ–≤ –≤ map

### –ü—Ä–æ–±–ª–µ–º–∞: Worker "–∑–∞—Å—ã–ø–∞–µ—Ç" –Ω–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–º —Ç–∞—Ä–∏—Ñ–µ Render

**–†–µ—à–µ–Ω–∏–µ:**
1. –ù–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–º —Ç–∞—Ä–∏—Ñ–µ Render worker –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ 15 –º–∏–Ω—É—Ç –±–µ–∑–¥–µ–π—Å—Ç–≤–∏—è
2. –ü–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏—è worker –¥–æ–ª–∂–µ–Ω "–ø—Ä–æ—Å–Ω—É—Ç—å—Å—è"
3. –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–ª–∞—Ç–Ω—ã–π —Ç–∞—Ä–∏—Ñ –∏–ª–∏ Railway.app

## –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

1. –î–æ–∂–¥–∏—Ç–µ—Å—å –¥–µ–ø–ª–æ—è –Ω–∞ Render.com
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ worker: `curl -X POST https://chatbot-tg.onrender.com/runner/start`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å: `curl https://chatbot-tg.onrender.com/runner/status`
4. –û–ø—É–±–ª–∏–∫—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–∞–Ω–∞–ª–µ
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Render.com - –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–±—ã—Ç–∏—è

